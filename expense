#!/usr/bin/env python

import psycopg2 
from psycopg2 import extras

connection = psycopg2.connect(dbname='expenses') 
try:
    with connection:
        with connection.cursor(cursor_factory=extras.DictCursor) as cursor:
            cursor.execute("""SELECT * FROM expenses
                          ORDER BY created_on DESC
                          """)
            all_rows = cursor.fetchall()
finally:
    connection.close()

for row in all_rows:
    columns = [
        str(row['id']).rjust(3),
        str(row['created_on']),
        str(row['amount']).rjust(12),
        str(row['memo'])
    ]
    
    print(' | '.join(columns))

